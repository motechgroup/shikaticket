RewriteEngine On

# Handle clean URLs for the application
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php [QSA,L]

# Security: Block access to sensitive files
<FilesMatch "\.(sql|log|md|txt)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Security: Block access to sensitive directories (using Files directive instead of DirectoryMatch)
<Files "config">
    Order Allow,Deny
    Deny from all
</Files>

<Files "app">
    Order Allow,Deny
    Deny from all
</Files>

<Files "database">
    Order Allow,Deny
    Deny from all
</Files>

<Files "storage">
    Order Allow,Deny
    Deny from all
</Files>

<Files "vendor">
    Order Allow,Deny
    Deny from all
</Files>